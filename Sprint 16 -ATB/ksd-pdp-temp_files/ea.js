var EmailAptitude=function(){return{setCookie:function(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/; domain="+document.domain.split(".").slice(-2).join(".")},getCookie:function(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null},eraseCookie:function(e){setCookie(e,"",-1)},parseUrlParams:function(){var e,t=/\+/g,n=/([^&=]+)=?([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(t," "))},i=window.location.search.substring(1),s={};while(e=n.exec(i))s[r(e[1])]=r(e[2]);return s},insertScript:function(e){var t=document.createElement("script");t.setAttribute("src",e),t.setAttribute("type","text/javascript");var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},on:function(e,t){window.attachEvent?window.attachEvent("on"+e,t):window.addEventListener(e,t,!1)}}}(),EmailAptitudeTracker=function(){function r(){var t=!1,n=EmailAptitude.getCookie(e.cookieName),r=EmailAptitude.parseUrlParams();return n?t=n:r[e.emailParam]?(t=r[e.emailParam],EmailAptitude.setCookie(e.cookieName,t,e.cookieExpiration)):window._ea.requireEmail===!1&&(t="testing@emailaptitude.com"),t}function i(){var e="";for(var n in t){var r=encodeURI(t[n]);typeof r=="string"&&r.length>0&&e.indexOf("&"+n+"=")==-1&&(e+="&"+n+"="+r)}return e}function s(){if(t.email)EmailAptitude.insertScript(("https:"==window.location.protocol?"https://":"http://")+e.serverDomain+"/post?callback="+e.namespace+".callback"+i());else if(window._ea.emailFromSelector!=undefined){var n;if(!jQuery){EmailAptitude.insertScript(("https:"==window.location.protocol?"https://":"http://")+e.serverDomain+"/sizzle.min.js");function r(){window.Sizzle?(n=Sizzle(window._ea.emailFromSelector),Object.prototype.toString.call(n)==="[object Array]"&&n.length>0?n[0].onblur=function(){EmailAptitude.setCookie(e.cookieName,n[0].value,e.cookieExpiration),t.email=n[0].value,EmailAptitude.insertScript(("https:"==window.location.protocol?"https://":"http://")+e.serverDomain+"/post?callback="+e.namespace+".callback"+i())}:console.log("EA: no elements match selector "+window._ea.emailFromSelector)):setTimeout(r,50)}r()}else n=jQuery(window._ea.emailFromSelector),n.length>0?n.on("blur",function(){EmailAptitude.setCookie(e.cookieName,$(this).val(),e.cookieExpiration),t.email=$(this).val(),EmailAptitude.insertScript(("https:"==window.location.protocol?"https://":"http://")+e.serverDomain+"/post?callback="+e.namespace+".callback"+i())}):console.log("EA: no elements match selector "+window._ea.emailFromSelector)}}function o(){t.pageUnloadTimestamp=(new Date/1e3).toFixed(0),s()}var e={serverDomain:"tracker.emailaptitude.com",serverURL:"http://tracker.emailaptitude.com/post",cookieName:"eaTrackerEmail",cookieExpiration:7300,emailParam:"email",namespace:"EmailAptitudeTracker"},t={accountId:window._ea.accountId,email:r(),domain:document.domain,url:document.URL,title:document.getElementsByTagName("title").length==0?"":document.getElementsByTagName("title")[0].innerHTML,resolution:screen.width+"x"+screen.height,userAgent:navigator.userAgent,referrer:document.referrer,pageLoadTimestamp:(new Date/1e3).toFixed(0)},n=!1;return{callback:function(e){n=!0,!t._id&&e._id!=""&&(t._id=e._id)},init:function(e){for(var t in e)e[t]=e[t];EmailAptitude.on("beforeunload",o),s()}}}();EmailAptitudeTracker.init();